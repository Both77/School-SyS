import{p as S,c as i,a as e,F as V,j,d as b,t as n,b as m,v as y,s as M,x as h,q as x,r as u,o as r}from"./index-CsmVEaGV.js";const N={class:"p-6 space-y-4"},$={class:"bg-white rounded shadow overflow-hidden"},A={class:"w-full text-sm"},B={class:"p-3"},F={class:"p-3"},T={class:"p-3"},I={class:"p-3"},L={class:"p-3"},R=["onClick"],q=["onClick"],z={key:0},P={key:0,class:"fixed inset-0 bg-black/40 flex items-center justify-center p-4"},G={class:"bg-white rounded shadow w-full max-w-lg p-4 space-y-3"},H={class:"flex items-center justify-between"},J={class:"font-semibold"},K={class:"grid gap-3"},O={class:"text-xs text-slate-600"},X={__name:"Index",setup(Q){const f=u([]),c=u(!1),d=u(null),a=u({name:"",email:"",password:"",role:"teacher"}),o=u(""),p=u(!0);function _(){a.value={name:"",email:"",password:"",role:"teacher"}}function k(){o.value="",p.value=!0,d.value=null,_(),c.value=!0}function C(l){o.value="",p.value=!0,d.value=l.id,a.value={name:l.name,email:l.email,password:"",role:l.role},c.value=!0}function g(){c.value=!1}async function w(){const{data:l}=await x.get("/users");f.value=l.data??l}async function D(){var l,t;o.value="";try{const s={...a.value};s.password||delete s.password,d.value?await x.put(`/users/${d.value}`,s):await x.post("/users",s),p.value=!0,o.value="Saved!",await w(),setTimeout(()=>c.value=!1,400)}catch(s){p.value=!1,o.value=((t=(l=s==null?void 0:s.response)==null?void 0:l.data)==null?void 0:t.message)||"Save failed"}}async function U(l){var t,s;if(confirm(`Delete user ${l.name}?`))try{await x.delete(`/users/${l.id}`),await w()}catch(v){alert(((s=(t=v==null?void 0:v.response)==null?void 0:t.data)==null?void 0:s.message)||"Delete failed")}}function E(l){return new Date(l).toLocaleDateString()}return S(async()=>{await w()}),(l,t)=>(r(),i("div",N,[e("div",{class:"flex items-center justify-between"},[t[4]||(t[4]=e("h1",{class:"text-xl font-semibold"},"User Management",-1)),e("button",{class:"px-3 py-2 rounded bg-slate-900 text-white text-sm",onClick:k}," + Add User ")]),e("div",$,[e("table",A,[t[7]||(t[7]=e("thead",{class:"bg-slate-50"},[e("tr",null,[e("th",{class:"text-left p-3"},"Name"),e("th",{class:"text-left p-3"},"Email"),e("th",{class:"text-left p-3"},"Role"),e("th",{class:"text-left p-3"},"Created"),e("th",{class:"text-left p-3"},"Action")])],-1)),e("tbody",null,[(r(!0),i(V,null,j(f.value,s=>(r(),i("tr",{key:s.id,class:"border-t"},[e("td",B,n(s.name),1),e("td",F,n(s.email),1),e("td",T,[e("span",{class:h(s.role==="admin"?"text-red-600 font-semibold":"text-blue-600")},n(s.role),3)]),e("td",I,n(E(s.created_at)),1),e("td",L,[e("button",{class:"text-blue-700",onClick:v=>C(s)},"Edit",8,R),t[5]||(t[5]=e("span",{class:"mx-2 text-slate-300"},"|",-1)),e("button",{class:"text-red-700",onClick:v=>U(s)},"Delete",8,q)])]))),128)),f.value.length===0?(r(),i("tr",z,[...t[6]||(t[6]=[e("td",{class:"p-4 text-slate-500",colspan:5},"No users found",-1)])])):b("",!0)])])]),c.value?(r(),i("div",P,[e("div",G,[e("div",H,[e("h2",J,n(d.value?"Edit User":"Add User"),1),e("button",{class:"text-slate-600",onClick:g},"âœ•")]),e("div",K,[e("div",null,[t[8]||(t[8]=e("label",{class:"text-xs text-slate-600"},"Name",-1)),m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>a.value.name=s),class:"w-full border rounded px-3 py-2 text-sm"},null,512),[[y,a.value.name]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"text-xs text-slate-600"},"Email",-1)),m(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>a.value.email=s),type:"email",class:"w-full border rounded px-3 py-2 text-sm"},null,512),[[y,a.value.email]])]),e("div",null,[e("label",O,"Password "+n(d.value?"(leave blank to keep current)":""),1),m(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>a.value.password=s),type:"password",class:"w-full border rounded px-3 py-2 text-sm"},null,512),[[y,a.value.password]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"text-xs text-slate-600"},"Role",-1)),m(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>a.value.role=s),class:"w-full border rounded px-3 py-2 text-sm"},[...t[10]||(t[10]=[e("option",{value:"teacher"},"Teacher",-1),e("option",{value:"admin"},"Admin",-1)])],512),[[M,a.value.role]])])]),e("div",{class:"flex justify-end gap-2 pt-2"},[e("button",{class:"px-3 py-2 rounded border bg-white text-sm",onClick:g},"Cancel"),e("button",{class:"px-3 py-2 rounded bg-slate-900 text-white text-sm",onClick:D}," Save ")]),o.value?(r(),i("p",{key:0,class:h(["text-sm",p.value?"text-green-700":"text-red-700"])},n(o.value),3)):b("",!0)])])):b("",!0)]))}};export{X as default};
