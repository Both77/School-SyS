import{p as D,c as a,a as e,F as g,j as k,d as w,t as p,b as h,s as E,v as M,x as N,q as x,r as n,o}from"./index-Cz2jkUhJ.js";const V={class:"p-6 space-y-4"},B={class:"bg-white rounded shadow overflow-hidden"},F={class:"w-full text-sm"},I={class:"p-3"},T={class:"p-3"},U={class:"p-3"},q=["onClick"],z=["onClick"],L={key:0},G={key:0,class:"fixed inset-0 bg-black/40 flex items-center justify-center p-4"},H={class:"bg-white rounded shadow w-full max-w-md p-4 space-y-3"},J={class:"flex items-center justify-between"},K={class:"font-semibold"},O=["value"],R={__name:"Index",setup(P){const m=n([]),f=n([]),u=n(!1),d=n(null),c=n(0),r=n(""),i=n(""),v=n(!0);function C(){var l;d.value=null,c.value=((l=m.value[0])==null?void 0:l.id)||0,r.value="",i.value="",v.value=!0,u.value=!0}function S(l){d.value=l.id,c.value=l.class_id,r.value=l.name,i.value="",v.value=!0,u.value=!0}function y(){u.value=!1}async function b(){m.value=(await x.get("/classes")).data,f.value=(await x.get("/sections")).data}async function j(){var l,t;i.value="";try{const s={class_id:c.value,name:r.value};d.value?await x.put(`/sections/${d.value}`,s):await x.post("/sections",s),v.value=!0,i.value="Saved!",await b(),setTimeout(()=>u.value=!1,400)}catch(s){v.value=!1,i.value=((t=(l=s==null?void 0:s.response)==null?void 0:l.data)==null?void 0:t.message)||"Save failed"}}async function $(l){confirm(`Delete section ${l.name}?`)&&(await x.delete(`/sections/${l.id}`),await b())}return D(b),(l,t)=>(o(),a("div",V,[e("div",{class:"flex items-center justify-between"},[t[2]||(t[2]=e("h1",{class:"text-xl font-semibold"},"Sections",-1)),e("button",{class:"px-3 py-2 rounded bg-slate-900 text-white text-sm",onClick:C},"+ Add Section")]),e("div",B,[e("table",F,[t[5]||(t[5]=e("thead",{class:"bg-slate-50"},[e("tr",null,[e("th",{class:"text-left p-3"},"Class"),e("th",{class:"text-left p-3"},"Section"),e("th",{class:"text-left p-3"},"Action")])],-1)),e("tbody",null,[(o(!0),a(g,null,k(f.value,s=>{var _;return o(),a("tr",{key:s.id,class:"border-t"},[e("td",I,p((_=s.class)==null?void 0:_.name),1),e("td",T,p(s.name),1),e("td",U,[e("button",{class:"text-blue-700",onClick:A=>S(s)},"Edit",8,q),t[3]||(t[3]=e("span",{class:"mx-2 text-slate-300"},"|",-1)),e("button",{class:"text-red-700",onClick:A=>$(s)},"Delete",8,z)])])}),128)),f.value.length===0?(o(),a("tr",L,[...t[4]||(t[4]=[e("td",{class:"p-4 text-slate-500",colspan:"3"},"No sections",-1)])])):w("",!0)])])]),u.value?(o(),a("div",G,[e("div",H,[e("div",J,[e("h2",K,p(d.value?"Edit Section":"Add Section"),1),e("button",{class:"text-slate-600",onClick:y},"âœ•")]),e("div",null,[t[7]||(t[7]=e("label",{class:"text-xs text-slate-600"},"Class",-1)),h(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>c.value=s),class:"w-full border rounded px-3 py-2 text-sm"},[t[6]||(t[6]=e("option",{disabled:"",value:0},"Select class",-1)),(o(!0),a(g,null,k(m.value,s=>(o(),a("option",{key:s.id,value:s.id},p(s.name),9,O))),128))],512),[[E,c.value,void 0,{number:!0}]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"text-xs text-slate-600"},"Section Name",-1)),h(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>r.value=s),class:"w-full border rounded px-3 py-2 text-sm",placeholder:"A"},null,512),[[M,r.value]])]),e("div",{class:"flex justify-end gap-2 pt-2"},[e("button",{class:"px-3 py-2 rounded border bg-white text-sm",onClick:y},"Cancel"),e("button",{class:"px-3 py-2 rounded bg-slate-900 text-white text-sm",onClick:j},"Save")]),i.value?(o(),a("p",{key:0,class:N(["text-sm",v.value?"text-green-700":"text-red-700"])},p(i.value),3)):w("",!0)])])):w("",!0)]))}};export{R as default};
