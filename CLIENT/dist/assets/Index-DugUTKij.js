import{p as S,c as o,a as e,F as N,j as $,d as f,t as p,b as y,v as _,x as D,q as x,r as n,o as u}from"./index-CsmVEaGV.js";const E={class:"p-6 space-y-4"},V={class:"bg-white rounded shadow overflow-hidden"},A={class:"w-full text-sm"},B={class:"p-3"},M={class:"p-3"},F={class:"p-3"},I=["onClick"],T=["onClick"],U={key:0},q={key:0,class:"fixed inset-0 bg-black/40 flex items-center justify-center p-4"},z={class:"bg-white rounded shadow w-full max-w-md p-4 space-y-3"},L={class:"flex items-center justify-between"},G={class:"font-semibold"},K={__name:"Index",setup(H){const b=n([]),d=n(!1),i=n(null),c=n(""),r=n(""),a=n(""),v=n(!0);function g(){i.value=null,c.value="",r.value="",a.value="",v.value=!0,d.value=!0}function h(l){i.value=l.id,c.value=l.name,r.value=l.code||"",a.value="",v.value=!0,d.value=!0}function w(){d.value=!1}async function m(){b.value=(await x.get("/subjects")).data}async function j(){var l,t;a.value="";try{const s={name:c.value,code:r.value||null};i.value?await x.put(`/subjects/${i.value}`,s):await x.post("/subjects",s),v.value=!0,a.value="Saved!",await m(),setTimeout(()=>d.value=!1,400)}catch(s){v.value=!1,a.value=((t=(l=s==null?void 0:s.response)==null?void 0:l.data)==null?void 0:t.message)||"Save failed"}}async function k(l){confirm(`Delete subject ${l.name}?`)&&(await x.delete(`/subjects/${l.id}`),await m())}return S(m),(l,t)=>(u(),o("div",E,[e("div",{class:"flex items-center justify-between"},[t[2]||(t[2]=e("h1",{class:"text-xl font-semibold"},"Subjects",-1)),e("button",{class:"px-3 py-2 rounded bg-slate-900 text-white text-sm",onClick:g},"+ Add Subject")]),e("div",V,[e("table",A,[t[5]||(t[5]=e("thead",{class:"bg-slate-50"},[e("tr",null,[e("th",{class:"text-left p-3"},"Name"),e("th",{class:"text-left p-3"},"Code"),e("th",{class:"text-left p-3"},"Action")])],-1)),e("tbody",null,[(u(!0),o(N,null,$(b.value,s=>(u(),o("tr",{key:s.id,class:"border-t"},[e("td",B,p(s.name),1),e("td",M,p(s.code||"-"),1),e("td",F,[e("button",{class:"text-blue-700",onClick:C=>h(s)},"Edit",8,I),t[3]||(t[3]=e("span",{class:"mx-2 text-slate-300"},"|",-1)),e("button",{class:"text-red-700",onClick:C=>k(s)},"Delete",8,T)])]))),128)),b.value.length===0?(u(),o("tr",U,[...t[4]||(t[4]=[e("td",{class:"p-4 text-slate-500",colspan:"3"},"No subjects",-1)])])):f("",!0)])])]),d.value?(u(),o("div",q,[e("div",z,[e("div",L,[e("h2",G,p(i.value?"Edit Subject":"Add Subject"),1),e("button",{class:"text-slate-600",onClick:w},"âœ•")]),e("div",null,[t[6]||(t[6]=e("label",{class:"text-xs text-slate-600"},"Name",-1)),y(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>c.value=s),class:"w-full border rounded px-3 py-2 text-sm"},null,512),[[_,c.value]])]),e("div",null,[t[7]||(t[7]=e("label",{class:"text-xs text-slate-600"},"Code",-1)),y(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>r.value=s),class:"w-full border rounded px-3 py-2 text-sm"},null,512),[[_,r.value]])]),e("div",{class:"flex justify-end gap-2 pt-2"},[e("button",{class:"px-3 py-2 rounded border bg-white text-sm",onClick:w},"Cancel"),e("button",{class:"px-3 py-2 rounded bg-slate-900 text-white text-sm",onClick:j},"Save")]),a.value?(u(),o("p",{key:0,class:D(["text-sm",v.value?"text-green-700":"text-red-700"])},p(a.value),3)):f("",!0)])])):f("",!0)]))}};export{K as default};
